page.goto("https://clue-dev.spreadwin.cn/user/login") # 登录元素
page.get_by_role("textbox", name="* 账号").click()
page.get_by_role("textbox", name="* 账号").fill("xiaojing")
page.get_by_role("textbox", name="* 账号").press("Enter")
page.get_by_role("textbox", name="* 账号").fill("xiaojing")
page.get_by_role("textbox", name="* 密码").click()
page.get_by_role("textbox", name="* 密码").fill("qwer123")
page.get_by_role("button", name="提交").click()
page.locator("a").filter(has_text="路眼平台").click()


# 首页元素
page.goto("https://clue-dev.spreadwin.cn/welcome")
page.get_by_text("本周").first.click()
page.get_by_text("本月").first.click()
page.get_by_text("安装数").click()
page.locator("span").filter(has_text=re.compile(r"^线索$")).click()
page.get_by_text("本周").nth(1).click()
page.get_by_text("本月").nth(2).click()
page.get_by_text("今日").nth(2).click()
page.locator(".ant-picker.ant-picker-borderless > .ant-picker-input").click()
page.get_by_text("4", exact=True).nth(1).click()
page.get_by_text("所有4S店").nth(1).click()
page.get_by_text("测试店铺", exact=True).nth(2).click()
page.get_by_text("周图").click()
page.get_by_text("月图").click()
page.get_by_text("年图").click()
page.get_by_role("tab", name="线索跟进情况").click()
page.get_by_role("tab", name="设备数量").click()
page.locator("a").filter(has_text="2").click()
page.locator("a").filter(has_text="3").click()

# 集团页面
page.goto("https://clue-dev.spreadwin.cn/corporation")
page.get_by_role("link", name="highlight 集团").click()
page.get_by_role("button", name="plus 添加集团").click()
page.get_by_role("textbox", name="* 集团名称 :").click()
page.get_by_role("textbox", name="* 集团名称 :").fill("非常集团")
page.get_by_role("textbox", name="* 集团简称 :").click()
page.get_by_role("textbox", name="* 集团简称 :").fill("集团")
page.get_by_role("textbox", name="* 负责人 :").click()
page.get_by_role("textbox", name="* 负责人 :").fill("你大爷")
page.get_by_role("textbox", name="* 负责人手机号 :").click()
page.get_by_role("textbox", name="* 负责人手机号 :").fill("18108047253")
page.get_by_role("radio", name="体验版").check()
page.get_by_role("spinbutton", name="* 最大设备数量 :").click()
page.get_by_role("textbox", name="* 集团地址 :").click()
page.get_by_role("textbox", name="* 集团地址 :").fill("成都市天府五街")
page.locator("div > .anticon > svg").click()
page.locator("div").filter(has_text="添加集团集团名称集团简称负责人负责人手机号集团版本体验版正式版最大设备数量集团地址头像上传关联渠道 请选择关联渠道取 消确 定").nth(4).set_input_files("1.jpeg")
page.locator(".ant-select-selection-overflow").click()
page.get_by_text("小镜").nth(3).click()
page.get_by_role("button", name="确 定").click()

# 导出页面
page.get_by_role("link", name="to-top 导出记录").click()
page.get_by_role("button", name="查 询").click()
page.get_by_role("textbox", name="时间 :").click()
page.get_by_role("button", name="上个月 (翻页上键)").click()
page.get_by_text("1", exact=True).nth(1).click()
page.get_by_text("4", exact=True).nth(3).click()
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("checkbox", name="敏感下载").check()
page.get_by_role("checkbox", name="脱敏下载").check()
page.get_by_role("textbox", name="页").click()
page.get_by_role("textbox", name="页").fill("5")
page.get_by_role("textbox", name="页").press("Enter")

# 车辆管理
page.get_by_text("车辆管理").click()
page.get_by_role("link", name="车辆列表").click()
page.get_by_role("textbox", name="设备号 :").click()
page.get_by_role("textbox", name="设备号 :").fill("869497052182449")
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("button", name="展开 up").click()
page.get_by_role("checkbox", name="已关联").check()
page.get_by_role("button", name="查 询").click()
page.get_by_role("checkbox", name="未关联").check()
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="导 出").click()
with page.expect_download() as download_info:
    with page.expect_popup() as page1_info:
        page.get_by_role("button", name="导出脱敏数据").click()
    page1 = page1_info.value
download = download_info.value
page1.close()
page.get_by_role("button", name="导 出").click()
page.get_by_role("button", name="导出敏感数据").click()
page.get_by_role("checkbox", name="我确认导出敏感信息数据，并自行承担可能造成的后果").check()
with page.expect_download() as download1_info:
    with page.expect_popup() as page2_info:
        page.get_by_role("button", name="导出敏感数据").click()
    page2 = page2_info.value
download1 = download1_info.value
page2.close()

# 设备管理
page.get_by_role("button", name="Close").click()
page.get_by_role("link", name="设备列表").click()
page.get_by_role("textbox", name="IMEI号 :").click()
page.get_by_role("textbox", name="IMEI号 :").fill("869497052182449")
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("textbox", name="服务时间 :").click()
page.get_by_role("button", name="上个月 (翻页上键)").click()
page.get_by_text("1", exact=True).nth(1).click()
page.get_by_text("28").nth(3).click()
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("button", name="导 出").click()
with page.expect_download() as download2_info:
    with page.expect_popup() as page3_info:
        page.get_by_role("button", name="导出脱敏数据").click()
    page3 = page3_info.value
download2 = download2_info.value
page3.close()
page.get_by_role("button", name="入库管理").click()
page.get_by_role("combobox", name="* 4S店名称 :").click()
page.get_by_text("测试店铺").nth(1).click()
page.get_by_role("textbox", name="设备号 :").click()
page.get_by_role("textbox", name="设备号 :").fill("869497052182449 573970116302449")
with page.expect_download() as download3_info:
    page.get_by_role("button", name="添加入库").click()
download3 = download3_info.value
page.get_by_role("button", name="Close").click()
page.get_by_role("textbox", name="页").click()
page.get_by_role("textbox", name="页").fill("3")
page.get_by_role("textbox", name="页").press("Enter")

# 信息异常用户
page.get_by_role("link", name="信息异常的用户").click()
page.get_by_role("textbox", name="IMEI号 :").click()
page.get_by_role("textbox", name="IMEI号 :").click()
page.get_by_role("textbox", name="IMEI号 :").fill("869497052182449")
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("textbox", name="用户注册的手机 :").click()
page.get_by_role("textbox", name="用户注册的手机 :").fill("18108047253")
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("link", name="设备授权").click()
page.get_by_role("textbox", name="IMEI号 :").click()
page.get_by_role("textbox", name="IMEI号 :").fill("869497052182449")
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("combobox", name="激活状态 :").click()
page.get_by_text("激活", exact=True).click()
page.get_by_role("button", name="查 询").click()
page.locator("#corporation").get_by_text("激活", exact=True).click()
page.get_by_text("未激活").click()
page.get_by_role("button", name="查 询").click()
page.get_by_role("combobox", name="是否授权 :").click()
page.get_by_text("是", exact=True).click()
page.get_by_role("button", name="查 询").click()
page.locator("#corporation").get_by_text("是", exact=True).click()
page.get_by_text("否", exact=True).click()
page.get_by_role("button", name="查 询").click()
page.get_by_role("button", name="重 置").click()
page.get_by_role("button", name="设备批量授权").click()
page.get_by_role("textbox", name="设备号 :").click()
page.get_by_role("textbox", name="设备号 :").fill("869497052182449")
page.get_by_role("button", name="添加授权").click()
page.get_by_role("button", name="Close").click()
with page.expect_download() as download4_info:
    with page.expect_popup() as page4_info:
        page.get_by_role("button", name="导 出").click()
    page4 = page4_info.value
download4 = download4_info.value
page4.close()
page.get_by_role("textbox", name="页").click()
page.get_by_role("textbox", name="页").fill("2")
page.get_by_role("textbox", name="页").press("Enter")

# 
page.get_by_role("menu").get_by_text("线索管理").click()
    page.get_by_text("所有", exact=True).click()
    page.get_by_role("textbox", name="车主手机 :").click()
    page.get_by_role("textbox", name="车主手机 :").fill("18108047253")
    page.get_by_role("button", name="查 询").click()
    page.get_by_role("button", name="重 置").click()
    page.locator("i").filter(has_text="未分配").click()
    page.get_by_text("已删除").click()
    page.get_by_text("我的").click()
    page.get_by_text("我已关闭").click()
    page.get_by_text("所有", exact=True).click()
    page.get_by_role("row", name="事故 387天 01/12 14:14:37 距离：0.").get_by_role("button").click()
    page.get_by_role("button", name="展开 up").click()
    page.get_by_role("textbox", name="设备号 :").click()
    page.get_by_role("textbox", name="设备号 :").fill("page.get_by_role(\"link\", name=\"信息异常的用户\").click()     page.get_by_role(\"textbox\", name=\"IMEI号 :\").click()     page.get_by_role(\"textbox\", name=\"IMEI号 :\").click()     page.get_by_role(\"textbox\", name=\"IMEI号 :\").fill(\"869497052182449\")     page.get_by_role(\"button\", name=\"查 询\").click()     page.get_by_role(\"button\", name=\"重 置\").click()     page.get_by_role(\"textbox\", name=\"用户注册的手机 :\").click()     page.get_by_role(\"textbox\", name=\"用户注册的手机 :\").fill(\"18108047253\")     page.get_by_role(\"button\", name=\"查 询\").click()     page.get_by_role(\"button\", name=\"重 置\").click()     page.get_by_role(\"link\", name=\"设备授权\").click()     page.get_by_role(\"textbox\", name=\"IMEI号 :\").click()     page.get_by_role(\"textbox\", name=\"IMEI号 :\").fill(\"869497052182449\")     page.get_by_role(\"button\", name=\"查 询\").click()     page.get_by_role(\"button\", name=\"重 置\").click()     page.get_by_role(\"combobox\", name=\"激活状态 :\").click()     page.get_by_text(\"激活\", exact=True).click()     page.get_by_role(\"button\", name=\"查 询\").click()     page.locator(\"#corporation\").get_by_text(\"激活\", exact=True).click()     page.get_by_text(\"未激活\").click()     page.get_by_role(\"button\", name=\"查 询\").click()     page.get_by_role(\"combobox\", name=\"是否授权 :\").click()     page.get_by_text(\"是\", exact=True).click()     page.get_by_role(\"button\", name=\"查 询\").click()     page.locator(\"#corporation\").get_by_text(\"是\", exact=True).click()     page.get_by_text(\"否\", exact=True).click()     page.get_by_role(\"button\", name=\"查 询\").click()     page.get_by_role(\"button\", name=\"重 置\").click()     page.get_by_role(\"button\", name=\"设备批量授权\").click()     page.get_by_role(\"textbox\", name=\"设备号 :\").click()     page.get_by_role(\"textbox\", name=\"设备号 :\").fill(\"869497052182449\")     page.get_by_role(\"button\", name=\"添加授权\").click()     page.get_by_role(\"button\", name=\"Close\").click()     with page.expect_download() as download4_info:         with page.expect_popup() as page4_info:             page.get_by_role(\"button\", name=\"导 出\").click()         page4 = page4_info.value     download4 = download4_info.value     page4.close()     page.get_by_role(\"textbox\", name=\"页\").click()     page.get_by_role(\"textbox\", name=\"页\").fill(\"2\")     page.get_by_role(\"textbox\", name=\"页\").press(\"Enter\")")
    page.get_by_role("button", name="close-circle").click()