# 自动化测试项目规则（6A Workflow）
本项目的自动化测试工作**严格遵循 6A 工作流**：
**Align → Architect → Atomize → Approve → Automate → Assess**
> **任何阶段未完成，不得进入下一阶段。**
---

## 阶段 1：Align ｜测试需求对齐
### 目标
将业务需求转化为**可自动化、可长期维护**的测试目标。
### 强制要求
1. 在编写任何测试代码前，**必须完成测试需求对齐**
2. 必须明确以下内容：
   - 被测系统边界（接口 / UI / 设备 / 协议）
   - 测试类型（接口 / UI / 集成 / 回归）
   - 自动化可行性与优先级
3. 必须分析现有测试资产：
   - 现有测试框架与技术栈
   - 公共测试能力（登录、数据、Mock、Driver）
   - 历史缺陷与高风险模块
### 必须输出
docs/[README].md
内容必须包含：
- 业务目标与主要风险点
- 自动化测试范围（In / Out）
- 明确不做自动化的说明及原因
- 待澄清问题（按优先级排序）
### 中断条件（任一满足即停止）
- 测试目标不清晰
- 自动化价值不成立
- 环境或测试数据不可控
---
## 阶段 2：Architect ｜自动化测试设计
### 目标
设计**可长期维护、可扩展**的自动化测试方案。
### 设计约束
1. 必须遵循测试金字塔：
   - 接口自动化为核心
   - UI 自动化仅覆盖核心主流程
2. 测试代码必须分层：
   - **Case**：仅表达测试意图
   - **Flow / Service / Page**：业务行为封装
   - **Infra / Utils**：技术能力与基础设施
3. 优先复用现有能力，**禁止重复造轮子**
### 必须输出
docs/[README].md
内容必须包含：
- 自动化测试架构图（Mermaid）
- 测试分层说明与职责边界
- 测试数据策略（构造 / 清理 / 隔离）
- 异常与失败处理策略
### 禁止行为
- UI 自动化过度覆盖
- Case 层出现任何实现细节
- 测试逻辑与测试数据强耦合
---
## 阶段 3：Atomize ｜测试任务拆解
### 目标
生成**可并行、可回滚、可复用**的原子测试任务。
### 拆解规则（必须同时满足）
1. 单个任务实现时间 ≤ 4 小时
2. 单任务只验证一个测试目标
3. 可独立执行、独立回滚
### 任务文档
docs/[README].md

内容必须包含：
- 前置条件（环境 / 数据）
- 测试输入
- 验证点（断言）
- 任务依赖关系图（Mermaid）
### 必须保证
- 测试任务之间无隐式依赖
- 公共能力优先下沉至 Infra / Utils
---
## 阶段 4：Approve ｜测试方案评审
### 目标
验证该自动化测试方案是否**值得长期维护**。
### 评审重点
- 自动化收益是否清晰
- 测试是否稳定、可复用
- 测试失败是否可快速定位
### 通过条件
- 所有测试点均有明确断言
- 数据与环境策略清晰
- 维护成本可接受
> **未通过必须回退至 Architect 或 Atomize 阶段重构。**
---
## 阶段 5：Automate ｜自动化测试实现

### 目标
交付**高稳定性、低维护成本**的自动化测试代码。

### 强制执行规范
1. 测试代码必须遵循工程化规范
2. 所有方法必须有**函数级中文注释**，明确测试意图
3. 单个测试方法职责单一，禁止过长
4. 禁止复制粘贴式自动化代码
5. 禁止魔法值，统一使用常量 / 枚举 / 数据对象
6. 并发执行必须考虑数据隔离与线程安全

### 异常处理原则
- 可恢复失败：记录问题并重试
- 不可恢复失败：立即失败并输出可定位信息
- 每次记录错误下次避免发生同类错误

### 强制同步更新
- 测试用例说明
- 测试数据说明
- CI / 本地执行说明
---
## 阶段 6：Assess ｜自动化测试评估
### 目标
形成自动化测试的**质量闭环**。
### 必须执行
```bash
./run_test.sh --all --task=[task_name]
docs/[README].md
内容必须包含：
自动化覆盖范围说明
稳定性结果（成功率 / 波动情况）
关键缺陷回溯
待改进清单
质量基线（未达标即失败）
核心接口覆盖率 ≥ 85%
用例成功率 ≥ 98%
不稳定用例必须标记并进入治理清单
自动化测试总原则（最高优先级）
自动化测试是长期工程资产
稳定性优先于覆盖率
可维护性优先于数量
Case 永远只表达测试意图